% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pcg.R
\name{M_inv}
\alias{M_inv}
\title{Diagonal (Jacobi) preconditioner application}
\usage{
M_inv(v, kdiag_full, obs_idx, noise_var)
}
\arguments{
\item{v}{Numeric vector to precondition (length \eqn{m}).}

\item{kdiag_full}{Vector \eqn{\mathrm{diag}(K)} of length \eqn{N}
(typically from `as.vector(kronecker(diag(space), diag(time)))`).}

\item{obs_idx}{Integer indices of observed entries in the full vector.}

\item{noise_var}{Scalar or length-\eqn{m} numeric nugget to add to the diagonal.}
}
\value{
A numeric vector of length \eqn{m}: elementwise `v / (diagA + 1e-12)`.
}
\description{
Divides by an approximation to the diagonal of the system,
which makes the iterative solver converge faster.
}
\details{
Technically: applies \eqn{M^{-1} v \approx v / \mathrm{diag}(A)}, where
\eqn{A = S K S^\top + \mathrm{diag}(\text{noise})} and
\eqn{\mathrm{diag}(K) = \mathrm{diag}(space) \otimes \mathrm{diag}(time)}.
}
