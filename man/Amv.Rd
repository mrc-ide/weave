% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit.R
\name{Amv}
\alias{Amv}
\title{Observed-system matvec: (S K S^T + diag(noise)) v}
\usage{
Amv(v, obs_idx, N, space_mat, time_mat, noise_var)
}
\arguments{
\item{v}{Numeric vector of length \eqn{m} (observed entries).}

\item{obs_idx}{Integer indices of observed entries in the full vector.}

\item{N}{Total length of the full vector.}

\item{space_mat}{Spatial kernel matrix.}

\item{time_mat}{Temporal kernel matrix.}

\item{noise_var}{Scalar or length-\eqn{m} numeric nugget on the observed scale.}
}
\value{
A numeric vector of length \eqn{m}, equal to \eqn{(S K S^\top + D)v}.
}
\description{
Takes an observed-length vector and applies the GP covariance
plus a per-observation noise (nugget), all without building any big matrices.
}
\details{
Technically: for \eqn{K = \mathrm{space}\,\otimes\,\mathrm{time}}, returns
\deqn{S\,K\,S^{\mathsf T}\,v \;+\; \operatorname{diag}(\sigma^2)\,v,}
i.e., the observed block of the GP plus a diagonal nugget. Implemented
matrix-free as \code{kron_mv(with_nas(v, obs_idx, N), space_mat, time_mat)[obs_idx] + noise_var * v},
where \eqn{S^{\mathsf T}} “scatters’’ into the full vector and \eqn{\sigma^2}
denotes the per-observation noise.
}
