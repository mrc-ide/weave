% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hyperparameter_cv.R
\name{tune_hyperparameters_optim}
\alias{tune_hyperparameters_optim}
\title{Tune hyperparameters by cross-validation}
\usage{
tune_hyperparameters_optim(
  obs_data,
  coordinates,
  id_col = "id",
  time_col = "t",
  n_sites_sample = 40,
  K_folds = 5,
  init = c(space = 20, t_per = 4, t_long = 12),
  lower = c(space = 5, t_per = 1, t_long = 3),
  upper = c(space = 200, t_per = 20, t_long = 52),
  seed = 123
)
}
\arguments{
\item{obs_data}{Data frame with one row per site-time. Must contain at
least `id`, `t`, `y_obs`, `mu_infer` and `f_infer`.}

\item{coordinates}{Data frame with site-level information including `id`.}

\item{id_col}{Name of the site identifier column.}

\item{time_col}{Name of the time column.}

\item{n_sites_sample}{Number of sites to randomly sample for tuning.}

\item{K_folds}{Number of cross-validation folds.}

\item{init}{Initial hyperparameter values.}

\item{lower}{Lower bounds for hyperparameters.}

\item{upper}{Upper bounds for hyperparameters.}

\item{seed}{Random seed for reproducibility.}
}
\value{
A list containing the best hyperparameters and optimisation details.
}
\description{
Subsample sites, build time-based folds and optimise the mean predictive
log-likelihood using `optim` with `L-BFGS-B` bounds.
}
\examples{
\dontrun{
init <- c(space = 3, t_per = 4, t_long = 12)
res <- tune_hyperparameters_optim(
  obs_data = obs_data,
  coordinates = coordinates,
  n_sites_sample = 20,
  K_folds = 10,
  init = init,
  lower = c(space = 0.01, t_per = 0.1, t_long = 1),
  upper = c(space = 100, t_per = 100, t_long = 24)
)
res$best_theta
}
}
