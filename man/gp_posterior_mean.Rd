% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/posterior.R
\name{gp_posterior_mean}
\alias{gp_posterior_mean}
\title{Posterior mean of the intensity surface}
\usage{
gp_posterior_mean(state, tol = 1e-06)
}
\arguments{
\item{state}{A sampler state created by \code{gp_build_state()}, containing
at least \code{space_mat}, \code{time_mat}, \code{obs_idx}, \code{N},
\code{y_work}, \code{noise_var}, \code{kdiag_full}, \code{A_solve},
and \code{mu_infer}. The vector layout is sites × times with time varying
fastest.}

\item{tol}{Convergence tolerance passed to the inner PCG solve.}
}
\value{
A numeric vector of length \code{state$N} giving the posterior mean
  intensity \eqn{\lambda} in the same ordering as \code{state$mu_infer}.
}
\description{
Computes the posterior mean of \eqn{\lambda = \exp(z)} where
\eqn{z = f + \mu_{\mathrm{infer}}}. The latent field \eqn{f} follows a
zero–mean GP with separable covariance \eqn{K = K_{\mathrm{space}} \otimes
K_{\mathrm{time}}}. A Gaussian working likelihood on the log scale with
heteroscedastic diagonal variance \eqn{D = \mathrm{diag}(\text{noise\_var})}
is used. This evaluates
\deqn{f_{\text{hat}} = K S^\top (S K S^\top + D)^{-1} y_{\text{work}},}
then returns \eqn{\exp(f_{\text{hat}} + \mu_{\mathrm{infer}})}.
}
