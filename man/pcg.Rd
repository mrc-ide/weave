% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pcg.R
\name{pcg}
\alias{pcg}
\title{Preconditioned Conjugate Gradient (PCG) solver for the observed system}
\usage{
pcg(
  b,
  obs_idx,
  N,
  space_mat,
  time_mat,
  noise_var,
  kdiag_full,
  tol = 1e-08,
  maxit = 10000
)
}
\arguments{
\item{b}{Right-hand side vector (observed length \eqn{m}).}

\item{obs_idx}{Integer indices of observed entries in the full vector.}

\item{N}{Total length of the full vector.}

\item{space_mat}{Spatial kernel matrix.}

\item{time_mat}{Temporal kernel matrix.}

\item{noise_var}{Scalar or length-\eqn{m} nugget on the observed scale.}

\item{kdiag_full}{Vector \eqn{\mathrm{diag}(K)} of length \eqn{N}.}

\item{tol}{Relative residual tolerance for convergence (default `1e-8`).}

\item{maxit}{Maximum number of iterations (default `10000`).}
}
\value{
Numeric solution vector `x` of length \eqn{m}.
}
\description{
In plain terms: solves the big linear system that gives the GP weights using
only matrix–vector products—no huge matrices, no explicit inverse.
}
\details{
Technically: solves \eqn{(S K S^\top + \mathrm{diag}(\text{noise}))\,x = b}
by PCG, using `Amv` for matrix–vector products and `M_inv` as a Jacobi
preconditioner. Stops when the relative residual falls below `tol` or after
`maxit` iterations (issues a warning on `maxit`).
}
