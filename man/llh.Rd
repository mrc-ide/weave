% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit.R
\name{llh}
\alias{llh}
\title{Hessian of the (log posterior) for Poisson log-Gaussian model}
\usage{
llh(f, dist_k_inv, time_k_inv)
}
\arguments{
\item{f}{Numeric vector of latent values (length \eqn{n \times nt}).}

\item{dist_k_inv}{Inverse spatial kernel (precision) matrix.}

\item{time_k_inv}{Inverse temporal kernel (precision) matrix.}
}
\value{
A dense square matrix \eqn{H} of size `length(f)` × `length(f)`.
}
\description{
Builds the curvature matrix used for uncertainty—combining
the GP prior and the Poisson likelihood—at a given latent vector `f`.
}
\details{
Technically: returns the Hessian
\deqn{H = -\Sigma^{-1} - \mathrm{diag}(\exp(f))}
where \eqn{\Sigma^{-1} = \text{dist\_k\_inv} \otimes \text{time\_k\_inv}}.
This is the Hessian of the log posterior (negative definite).
}
